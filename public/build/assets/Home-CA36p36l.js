import{j as e,r as u,a as ee}from"./app-uKq0dmXU.js";import{S as I,a as R,b as M,c as B,d as p}from"./select-9gWfZeHy.js";import{o as F}from"./orders-D7kIn_W2.js";import{C,a as D,d as A,e as S,b as T}from"./card-BcgImZpK.js";import{i as te,I as ae}from"./index-DkGKdz_0.js";import{U as z,W as se,D as j,T as re,R as K,A as le,C as ne,X as ie,Y as de,a as oe,b as W,P as ce,c as ge,d as xe,L as me}from"./Dashboard-kH0nlRUP.js";import{C as ue}from"./circle-check-big-BVwAlkvB.js";import{C as he}from"./calendar-C0b-SCEI.js";import{L as pe}from"./Layout-8xWoRnAE.js";import"./index-DTgWhUJq.js";import"./input-DzCUmDaK.js";import"./dialog-CQqfSJap.js";import"./index-Ch0uS5Sl.js";import"./index-DeL1XQ9p.js";import"./index-SYwxxIpT.js";const m=({title:a,value:l,description:t,icon:s,colorClass:r,bgClass:i})=>e.jsxs(C,{className:"shadow-md hover:shadow-lg transition-shadow duration-300 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[e.jsxs(D,{className:`${i} p-4 rounded-t-lg`,children:[e.jsxs(A,{className:"flex items-center gap-2 text-gray-800 dark:text-gray-100 text-lg sm:text-xl font-semibold",children:[e.jsx(s,{className:`w-6 h-6 sm:w-7 sm:h-7 ${r}`}),a]}),e.jsx(S,{className:"text-gray-600 dark:text-gray-400 text-sm",children:t})]}),e.jsx(T,{className:"p-4",children:e.jsx("p",{className:`text-3xl sm:text-4xl font-bold ${r} flex items-center`,children:a.includes("Amount")||a.includes("Expenses")||a.includes("Revenue")?e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:20,className:"mr-1"})," ",l.toFixed(2)]}):l})})]}),ye=({companyOrders:a,filteredOrders:l,successfulPayments:t,totalActualPayAmount:s,totalPaidAmount:r,totalPendingAmount:i,totalExpensesAmount:o,netRevenue:n})=>e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[e.jsx(m,{title:"Total Orders",value:a.length,description:"All company orders",icon:te,colorClass:"text-indigo-600 dark:text-indigo-400",bgClass:"bg-indigo-50 dark:bg-indigo-900"}),e.jsx(m,{title:"My Orders",value:l.length,description:"Your personal orders",icon:z,colorClass:"text-teal-600 dark:text-teal-400",bgClass:"bg-teal-50 dark:bg-teal-900"}),e.jsx(m,{title:"Paid Orders",value:t.length,description:"Successful payments",icon:ue,colorClass:"text-green-600 dark:text-green-400",bgClass:"bg-green-50 dark:bg-green-900"}),e.jsx(m,{title:"Total Order Amount",value:s,description:"Total amount owed",icon:se,colorClass:"text-blue-600 dark:text-blue-400",bgClass:"bg-blue-50 dark:bg-blue-900"}),e.jsx(m,{title:"Total Paid Amount",value:r,description:"Total payments received",icon:j,colorClass:"text-purple-600 dark:text-purple-400",bgClass:"bg-purple-50 dark:bg-purple-900"}),e.jsx(m,{title:"Total Pending Amount",value:i,description:"Total amount pending",icon:j,colorClass:"text-orange-600 dark:text-orange-400",bgClass:"bg-orange-50 dark:bg-orange-900"}),e.jsx(m,{title:"Total Expenses",value:o,description:"All recorded expenses",icon:j,colorClass:"text-red-600 dark:text-red-400",bgClass:"bg-red-50 dark:bg-red-900"}),e.jsx(m,{title:"Net Revenue",value:n,description:"Revenue after expenses",icon:j,colorClass:"text-yellow-600 dark:text-yellow-400",bgClass:"bg-yellow-50 dark:bg-yellow-900"})]}),k=({title:a,data:l,timeRange:t,color:s,gradientId:r,bgClass:i,iconColor:o})=>e.jsxs(C,{className:"shadow-md hover:shadow-lg transition-shadow duration-300 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[e.jsxs(D,{className:`${i} p-4 rounded-t-lg`,children:[e.jsxs(A,{className:"flex items-center gap-2 text-gray-800 dark:text-gray-100 text-lg sm:text-xl font-semibold",children:[e.jsx(re,{className:`w-6 h-6 sm:w-7 sm:h-7 ${o}`}),a]}),e.jsx(S,{className:"text-gray-600 dark:text-gray-400 text-sm",children:t==="All"?"All time":`Last ${t} days`})]}),e.jsx(T,{className:"p-4 sm:p-6",children:e.jsx(K,{width:"100%",height:300,children:l.length>0?e.jsxs(le,{data:l,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:r,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:s,stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:s,stopOpacity:0})]})}),e.jsx(ne,{strokeDasharray:"3 3",stroke:"#e0e0e0",opacity:.5}),e.jsx(ie,{dataKey:"date",stroke:"#666",tick:{fill:"#666",fontSize:12},tickFormatter:n=>t==="All"?n:n.split("-").slice(1).join("-")}),e.jsx(de,{stroke:"#666",tick:{fill:"#666",fontSize:12}}),e.jsx(oe,{type:"monotone",dataKey:"orders",stroke:s,strokeWidth:2,fill:`url(#${r})`,dot:{r:4,fill:s}}),e.jsx(W,{contentStyle:{backgroundColor:"#fff",borderRadius:"6px",border:"1px solid #e0e0e0"},labelStyle:{color:"#333"},itemStyle:{color:s},labelFormatter:n=>`Date: ${n}`,formatter:n=>Math.round(n)})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400 text-sm",children:"No data available for this range"})})})]}),v=["#6b7280","#f97316","#22c55e","#3b82f6","#a855f7"],be=({top5Users:a,filteredOrders:l,timeRange:t})=>e.jsxs(C,{className:"shadow-md hover:shadow-lg transition-shadow duration-300 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 col-span-1 lg:col-span-2",children:[e.jsxs(D,{className:"bg-indigo-50 dark:bg-indigo-900 p-4 rounded-t-lg flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs(A,{className:"flex items-center gap-2 text-gray-800 dark:text-gray-100 text-lg sm:text-xl font-semibold",children:[e.jsx(z,{className:"w-6 h-6 sm:w-7 sm:h-7 text-indigo-600 dark:text-indigo-400"}),"Order Distribution (Top 5 Users)"]}),e.jsx(S,{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:t==="All"?"All time":`Last ${t} days`})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 sm:mt-0 bg-indigo-100 dark:bg-indigo-800 px-3 py-1 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total Orders:"}),e.jsx("span",{className:"text-lg font-bold text-indigo-600 dark:text-indigo-400",children:l.length})]})]}),e.jsx(T,{className:"p-4 sm:p-6",children:e.jsx(K,{width:"100%",height:300,children:a.length>0?e.jsxs(ce,{children:[e.jsx(ge,{data:a,dataKey:"value",nameKey:"name",innerRadius:"50%",outerRadius:"80%",paddingAngle:5,animationDuration:800,animationBegin:100,labelLine:!1,label:({name:s,value:r})=>`${s}: ${r}`,children:a.map((s,r)=>e.jsx(xe,{fill:v[r%v.length]},`cell-${r}`))}),e.jsx(W,{contentStyle:{backgroundColor:"#fff",borderRadius:"6px",border:"1px solid #e0e0e0"},labelStyle:{color:"#333"},formatter:(s,r)=>[`${s} orders`,r]}),e.jsx(me,{layout:"vertical",verticalAlign:"middle",align:"right",wrapperStyle:{paddingLeft:"20px",fontSize:"14px",color:"#333"},formatter:(s,r)=>e.jsxs("span",{style:{color:v[r.payload.payload.fill?v.indexOf(r.payload.payload.fill):0]},children:[s,": ",r.payload.value]})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400 text-sm",children:"No user data available"})})})]}),fe=({orders:a})=>{const[l,t]=u.useState("all"),s=new Date(a[0].delivered_date);console.log("deliver date ",s),console.log(s>new Date);const i=a.filter(n=>{if(!n.delivered_date)return!1;const c=new Date(n.delivered_date),b=new Date;return!isNaN(c.getTime())&&c>b}).sort((n,c)=>new Date(n.delivered_date)-new Date(c.delivered_date));console.log(i);const o=i.filter(n=>{const g=(new Date(n.delivered_date)-new Date)/(1e3*3600*24);return l==="week"?g<=7:l==="month"?g<=30:!0});return e.jsxs(C,{className:"shadow-md hover:shadow-lg transition-shadow duration-300 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[e.jsxs(D,{className:"bg-purple-50 dark:bg-purple-900 p-4 rounded-t-lg flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs(A,{className:"flex items-center gap-2 text-gray-800 dark:text-gray-100 text-lg sm:text-xl font-semibold",children:[e.jsx(he,{className:"w-6 h-6 sm:w-7 sm:h-7 text-purple-600 dark:text-purple-400"}),"Upcoming Deliveries"]}),e.jsx(S,{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:"Orders scheduled for delivery"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 sm:mt-0",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Filter:"}),e.jsxs(I,{value:l,onValueChange:t,children:[e.jsx(R,{className:"w-[120px] rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100",children:e.jsx(M,{placeholder:"All"})}),e.jsxs(B,{className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",children:[e.jsx(p,{value:"all",className:"text-gray-800 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",children:"All Upcoming"}),e.jsx(p,{value:"week",className:"text-gray-800 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Next 7 Days"}),e.jsx(p,{value:"month",className:"text-gray-800 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Next 30 Days"})]})]})]})]}),e.jsx(T,{className:"p-4 sm:p-6",children:o.length>0?e.jsx("div",{className:"space-y-4 max-h-[300px] overflow-y-auto",children:o.map(n=>e.jsxs("div",{className:"flex justify-between items-center border-b pb-2 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-800 dark:text-gray-100",children:["Order #",n.id," - ",n.user_name||"Unknown"]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Status: ",n.status]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-purple-600 dark:text-purple-400",children:[n.delivered_date," "]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[Math.ceil((new Date(n.delivered_date)-new Date)/(1e3*3600*24))," days"]})]})]},n.id))}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500 dark:text-gray-400 text-sm",children:"No upcoming deliveries found"})})]})},je=a=>{const l=[];for(let t=a-1;t>=0;t--){const s=new Date;s.setDate(s.getDate()-t),l.push(s.toISOString().split("T")[0])}return l},w=(a,l)=>{const t={};return l.forEach(s=>{t[s]=0}),a==null||a.forEach(s=>{const r=new Date(s==null?void 0:s.created_at).toISOString().split("T")[0];t[r]!==void 0&&t[r]++}),l.map(s=>({date:s,orders:t[s]||0}))},ke=(a,l)=>{const t=new Date;return(a==null?void 0:a.filter(s=>{const r=new Date(s==null?void 0:s.created_at);return l==="All"?!0:(t-r)/(1e3*3600*24)<=l}))||[]},ve=a=>{const l=(a==null?void 0:a.reduce((t,s)=>{const r=(s==null?void 0:s.user_id)||"unknown";return t[r]=(t[r]||0)+1,t},{}))||{};return Object.entries(l).sort(([,t],[,s])=>s-t).slice(0,5).map(([t,s])=>({name:t==="unknown"?"Unknown User":`User ${t}`,value:s}))},we=(a,l)=>{var s;const t=new Set(l==null?void 0:l.map(r=>{var i;return(i=r==null?void 0:r.id)==null?void 0:i.toString()}));return((s=a==null?void 0:a.filter(r=>t.has(r==null?void 0:r.order_id)))==null?void 0:s.reduce((r,i)=>{var o;return r+(((o=i==null?void 0:i.expenses)==null?void 0:o.reduce((n,c)=>n+parseFloat((c==null?void 0:c.amount)||0),0))||0)},0))||0},Ne=a=>(a==null?void 0:a.reduce((l,t)=>l+parseFloat((t==null?void 0:t.total_amount)||0),0))||0,Ce=a=>(a==null?void 0:a.reduce((l,t)=>l+parseFloat((t==null?void 0:t.paid_payment)||0),0))||0,De=a=>(a==null?void 0:a.reduce((l,t)=>l+parseFloat((t==null?void 0:t.pending_payment)||0),0))||0,N=a=>{if(!(a!=null&&a.length))return[];const l={};return a.forEach(t=>{const r=new Date(t==null?void 0:t.created_at).toLocaleString("default",{month:"short",year:"numeric"});l[r]=(l[r]||0)+1}),Object.keys(l).map(t=>({date:t,orders:l[t]}))},Ae=()=>{const[a,l]=u.useState([]),[t,s]=u.useState([]),[r,i]=u.useState([]),[o,n]=u.useState(null),[c,b]=u.useState(!0),[g,V]=u.useState("All");if(u.useEffect(()=>{(async()=>{var E;try{const[y,P,_]=await Promise.all([F.getAllOrders(),F.getUserOrders(),ee.get("api/expenses")]);l((y==null?void 0:y.orders)||[]),s((P==null?void 0:P.orders)||[]),i(((E=_==null?void 0:_.data)==null?void 0:E.data)||[])}catch(y){n("Failed to fetch data. Please try again later."),console.error("Error fetching data:",y)}finally{b(!1)}})()},[]),c)return e.jsx("div",{className:"p-6 text-center",children:"Loading Dashboard..."});if(o)return e.jsx("div",{className:"p-6 text-center text-red-600",children:o});const h=g==="All"?"All":parseInt(g),f=h==="All"?[]:je(h),d=ke(t,h),Y=ve(d),L=we(r,d),G=Ne(d),U=Ce(d),X=De(d),H=U-L,O=(d==null?void 0:d.filter(x=>(x==null?void 0:x.status)==="paid"))||[],$=(d==null?void 0:d.filter(x=>(x==null?void 0:x.status)==="pending"))||[],q=h==="All"?N(a):w(a,f),J=h==="All"?N(d):w(d,f),Q=h==="All"?N(O):w(O,f),Z=h==="All"?N($):w($,f);return e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 lg:p-10 bg-gray-50 dark:bg-gray-900 min-h-screen",children:[e.jsxs("div",{className:"mb-6 sm:mb-8 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800 dark:text-gray-100 tracking-tight",children:"Dashboard"}),e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Time Range:"}),e.jsxs(I,{value:g,onValueChange:V,children:[e.jsx(R,{className:"w-[140px] sm:w-[150px]",children:e.jsx(M,{placeholder:"All Time"})}),e.jsxs(B,{children:[e.jsx(p,{value:"7",children:"Last 7 Days"}),e.jsx(p,{value:"30",children:"Last 30 Days"}),e.jsx(p,{value:"All",children:"All Time"})]})]})]})]}),e.jsx(ye,{companyOrders:a,filteredOrders:d,successfulPayments:O,totalActualPayAmount:G,totalPaidAmount:U,totalPendingAmount:X,totalExpensesAmount:L,netRevenue:H}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[e.jsx(k,{title:"Company Orders Trend",data:q,timeRange:g,color:"#0070f3",gradientId:"colorOrders",bgClass:"bg-indigo-50 dark:bg-indigo-900",iconColor:"text-indigo-600 dark:text-indigo-400"}),e.jsx(k,{title:"My Orders Trend",data:J,timeRange:g,color:"#00b894",gradientId:"colorMyOrders",bgClass:"bg-teal-50 dark:bg-teal-900",iconColor:"text-teal-600 dark:text-teal-400"}),e.jsx(k,{title:"Successful Payments Trend",data:Q,timeRange:g,color:"#2ecc71",gradientId:"colorSuccess",bgClass:"bg-green-50 dark:bg-green-900",iconColor:"text-green-600 dark:text-green-400"}),e.jsx(k,{title:"Pending Payments Trend",data:Z,timeRange:g,color:"#f39c12",gradientId:"colorPending",bgClass:"bg-orange-50 dark:bg-orange-900",iconColor:"text-orange-600 dark:text-orange-400"}),e.jsx(be,{top5Users:Y,filteredOrders:d,timeRange:g}),e.jsx(fe,{orders:t})]})]})};function Ke(){return console.log("API URL:","https://crm.aryanevents.com/user/public"),e.jsx(pe,{children:e.jsx(Ae,{})})}export{Ke as default};
