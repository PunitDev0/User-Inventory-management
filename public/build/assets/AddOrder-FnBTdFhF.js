import{r as d,j as e,a as F}from"./app-CnuuUVAv.js";import{L as E}from"./Layout-CZWFnRXh.js";import{u as I}from"./index.esm-Ctihm-d5.js";import{P as k}from"./progress-Mq-GDWPi.js";import{I as r}from"./input-BAMlnd9k.js";import{B as z}from"./index-Fdi4hGc0.js";import{C as h,a as j,b as f,c as L}from"./card-DFevLNd8.js";import{f as D}from"./Api-DcUHNoqF.js";import{L as R,y as B}from"./index-B21byFpd.js";/* empty css                      */import{I as b}from"./indian-rupee-BpsN2FII.js";import"./index-9eWm-de7.js";import"./index-C1K0-1mr.js";function M({id:n}){const{register:a,handleSubmit:g,setValue:P,watch:m,formState:{errors:o},reset:C}=I(),[c,y]=d.useState({id:1,name:"Smartphone",image:"https://via.placeholder.com/100",quantity:1,amount:100}),[i,v]=d.useState({}),[u,p]=d.useState("");d.useEffect(()=>{(async()=>{try{const s=await D(n);v(s[0])}catch(s){console.error(s)}})()},[n]);const w=(t,s)=>{s>i.stock_quantity?p("Quantity exceeds available stock."):(p(""),y(x=>({...x,[t]:s})),P("quantity",s))},l=parseFloat(i.price)*c.quantity||0,A=parseFloat(m("paid_amount"))||0,N=Math.max(l-A,0),_=async t=>{try{const s={...t,products:[{product_id:i.id,product_name:i.productName,quantity:c.quantity,product_price:i.price,total_price:l}],total_amount:l,pending_payment:N},x=await F.post("/OrderStore",s);console.log("Order placed successfully",x.data),C({name:"",email:"",phone:"",address:"",city:"",zip:"",paid_amount:"",quantity:1}),B.success("Order placed successfully"),y({id:1,name:"",image:"",quantity:1,amount:0}),p("")}catch(s){console.error("Error placing order",s)}};let O=Object.values(m()).filter(t=>t!=="").length,S=c.amount!==""?1:0,q=Math.min((O+S)/(Object.keys(m()).length+1)*100,100);return e.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Complete Your Order"}),e.jsx(R,{position:"top-right",autoClose:3e3}),e.jsx(k,{value:q,className:"mb-6"}),e.jsxs(h,{className:"mb-4",children:[e.jsx(j,{children:"Order Summary"}),e.jsx(f,{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:i.productName}),e.jsx(r,{type:"number",value:c.quantity,...a("quantity",{valueAsNumber:!0,min:1,required:"Quantity is required"}),onChange:t=>w("quantity",parseInt(t.target.value)||1),className:"w-20 text-center"}),u&&e.jsx("p",{className:"text-red-500 text-sm",children:u}),o.quantity&&e.jsx("p",{className:"text-red-500 text-sm",children:o.quantity.message})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-semibold",children:"Price:"}),e.jsx("span",{className:"text-xl font-bold",children:i.price})]})]})}),e.jsxs(L,{className:"flex flex-col space-y-2 font-bold",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("span",{children:"Total Price:"}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(b,{size:15}),l.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("span",{children:"Paid Amount:"}),e.jsx(r,{type:"number",min:"0",max:l,placeholder:"Enter Paid Amount",...a("paid_amount",{valueAsNumber:!0,required:"Paid amount is required",validate:t=>{const s=l/2;return t>=s||`Paid amount must be at least half of the total amount. (${s.toFixed(2)})`}}),className:"w-24 text-center"}),o.paid_amount&&e.jsx("p",{className:"text-red-500 text-sm",children:o.paid_amount.message})]}),e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("span",{children:"Remaining Amount:"}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(b,{size:15}),N.toFixed(2)]})]})]})]}),e.jsxs(h,{className:"mb-4",children:[e.jsx(j,{children:"Personal Details"}),e.jsxs(f,{className:"space-y-3",children:[e.jsx(r,{...a("name",{required:"Name is required"}),placeholder:"Full Name"}),e.jsx(r,{...a("email",{required:"Email is required"}),placeholder:"Email Address"}),e.jsx(r,{...a("phone",{required:"Phone number is required"}),placeholder:"Phone Number"})]})]}),e.jsxs(h,{className:"mb-4",children:[e.jsx(j,{children:"Shipping Address"}),e.jsxs(f,{className:"space-y-3",children:[e.jsx(r,{...a("address",{required:"Address is required"}),placeholder:"Street Address"}),e.jsx(r,{...a("city",{required:"City is required"}),placeholder:"City"}),e.jsx(r,{...a("zip",{required:"ZIP Code is required"}),placeholder:"ZIP Code"})]})]}),e.jsx(z,{className:"w-full mt-4",disabled:q<100||u,onClick:g(_),children:"Place Order"})]})}function ee({id:n}){return e.jsx(E,{children:e.jsx(M,{id:n})})}export{ee as default};
